# План: Skill для управления задачами Битрикс24

## Что создаём

Проектный skill для Claude Code в `.claude/skills/bitrix24-tasks/SKILL.md`.

Один файл SKILL.md содержит всё: триггеры активации, справку по API Битрикс24, шаблоны curl-команд.

## Как работает

- **Авторизация**: переменная окружения `BITRIX24_WEBHOOK_URL` (вида `https://xxx.bitrix24.ru/rest/1/abc123/`)
- **Вызовы API**: через `curl -s` в Bash
- **Активация**: автоматически при упоминании задач Битрикс24, B24

## Операции в SKILL.md

| Метод API | Описание | Подтверждение |
|-----------|----------|---------------|
| `tasks.task.list` | Список задач (фильтры, сортировка, пагинация) | Нет |
| `tasks.task.get` | Детали задачи по ID | Нет |
| `tasks.task.add` | Создать задачу | Нет |
| `tasks.task.update` | Обновить задачу (поля, статус, дедлайн) | Нет |
| `tasks.task.delete` | Удалить задачу | **Да — спросить у пользователя** |
| `task.commentitem.add` | Добавить комментарий | Нет |
| `task.commentitem.getlist` | Список комментариев задачи | Нет |

## Важное правило

**Перед удалением задачи (`tasks.task.delete`) обязательно запросить подтверждение у пользователя через AskUserQuestion.** Все остальные операции выполняются без подтверждения.

## Содержание SKILL.md

SKILL.md должен включать:

1. **Frontmatter** — name, description с триггерными фразами (задачи битрикс, b24, bitrix24)
2. **Проверка переменной** — перед любым вызовом проверить что `BITRIX24_WEBHOOK_URL` задана
3. **Справка по API** — для каждого метода:
   - URL формирования запроса
   - Обязательные и опциональные параметры
   - Шаблон curl-команды
   - Пример ответа (ключевые поля)
4. **Статусы задач** — маппинг числовых статусов Битрикс24:
   - 2 = Ждёт выполнения
   - 3 = Выполняется
   - 4 = Ожидает контроля
   - 5 = Завершена
   - 6 = Отложена
5. **Формат вывода** — как представлять результаты пользователю (таблицы, краткие сводки)
6. **Правило удаления** — всегда спрашивать подтверждение перед delete

## Файлы для создания

```
.claude/skills/bitrix24-tasks/
└── SKILL.md
```

## Верификация

Запустить Claude Code в проекте up_advert_bot и попросить "покажи задачи в Битрикс24" — skill должен активироваться и выполнить curl-запрос.
